/* graphane - 0.1.0-alpha.5 */ var x=new WeakSet;function v(t){if(x.has(t))return;let e=t.getScreenCTM(),s=()=>{let n=t.getScreenCTM();n!==null&&(n.a!==e.a||n.b!==e.b||n.c!==e.c||n.d!==e.d||n.e!==e.e||n.f!==e.f)&&(t.dispatchEvent(new CustomEvent("resize",{detail:{currentMatrix:n,prevMatrix:e}})),e=n),window.requestAnimationFrame(s)};x.add(t),s()}function p(t){t.extendInstance(e=>{e.addEventListener=function(s,n,a){s==="resize"&&this.el.tagName.toLowerCase()==="svg"&&v(this.el),this.el.addEventListener(s,n,a)}})}var r=Symbol(),k=t=>t?.split(/\)\s*/).filter(e=>!!e).map(e=>e.split(/\s*\(/)).reduce((e,s)=>(e[s.shift()]=s.pop().split(/,/).map(n=>Number.isNaN(Number(n))?n:Number(n)),e),{})||{};function l(t="size"){let e=this.closest("svg");return e?e._el.getRootNode()===e._el?(e.addEventListener("attach",()=>{l.call(this,t)}),this):(this[r]&&e.removeEventListener("resize",this[r]),t==="stroke"&&M(e,this),t==="size"&&C(e,this),e.addEventListener("resize",this[r]),this):(this.top().addEventListener("attach",()=>{l.call(this,t)}),this)}function C(t,e){let s=t.getScreenCTM()||{a:1,d:1},n=e.tagName().toLowerCase(),a=n==="text"?{x:e.x(),y:e.y()}:n==="circle"?{x:e.cx(),y:e.cy()}:e.getBBox(),i=k(e.transform());i.scale||(i.scale=[1,1]),i.translate||(i.translate=[0,0]),s.a=s.a*i.scale[0],s.d=s.d*i.scale[1],e[r]=g=>{let c=g.detail.currentMatrix,d=e.transform("").transform,f=s.a/c.a,h=s.d/c.d,u=a.x*(c.a/s.a)-a.x,m=a.y*(c.d/s.d)-a.y;Object.keys(i).filter(o=>!["scale","translate"].includes(o)).forEach(o=>d[o](...i[o])),(f!==1||h!==1)&&d.scale(f,h),(u!==0||m!==0)&&d.translate(u,m)}}function M(t,e){let s=t.getScreenCTM()||{a:1,d:1};e.el._strokeWidth=parseFloat(getComputedStyle(e._el).strokeWidth),e[r]=n=>{let a=n.detail.currentMatrix;e.style.strokeWidth(e.el._strokeWidth*Math.max(s.a/a.a,s.d/a.d))}}function T(t){t.install(p),t.extendInstance({keepAspect:l}),t.extendTemplate&&t.extendTemplate.defineDirective({name:"g-keep-aspect",execute(e,{expression:s}){e.keepAspect(s)}})}export{T as svgPlugin}; //# sourceMappingURL=gsvg.keep.aspect.js.map