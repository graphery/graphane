/* graphane - 0.1.0-alpha.5 */ (()=>{var Fe="function",qt="undefined",S="object",L="string",W="array",v="number",V="boolean",Ve="date",ke="symbol",k="",tt=",";var Ge=";",E=t=>typeof t===S,N=t=>typeof t===L,h=t=>typeof t===Fe,Wt=t=>typeof t===v&&!isNaN(t),g=t=>typeof t===qt,Jt=t=>typeof t===ke,Yt=t=>typeof t===V,U=t=>Array.isArray(t),$t=t=>t instanceof Date&&!isNaN(t),R=t=>t===null,Xt=t=>t.replace(/-([a-z0-9])/g,(e,n)=>n.toUpperCase());function Be(t){if(N(t))try{let e=t.replace(/^\s*{/,"").replace(/}\s*$/,"").split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(n=>!["",";",","].includes(n.trim())).map(n=>n.split(":")).map(n=>`"${n[0].trim()}":${X(n[1].trim(),void 0,!0)}`).join(",");return JSON.parse(`{${e}}`)}catch(e){console.error(e);return}else if(E(t))return t}function Kt(t){if(N(t))return t.trim().startsWith("[")?(t.match(/\[(.*?)[^\]]]/g)||[]).map(e=>Kt(e.substring(1,e.length-1))):t.split(/[,;]/).map(e=>X(e.trim()));if(U(t))return t}function X(t,e,n=!1){if(!N(t))return t;if(t=He(t.trim()),e===W)return Kt(t);if(e===S)return Be(t);if(g(e)||e===v){if(g(t)||t==="")return;let i=+t;if(!Number.isNaN(i)||e===v)return i}if(g(e)||e===V){if(t==="true")return!0;if(t==="false")return!1;if(e===V)return t==="0"?!1:!!t}if(e===Ve){try{let i=new Date(t);if(!Number.isNaN(i.getTime()))return i}catch{}return}if(g(e)||e===L)return n?`"${t}"`:t}function He(t){return t[0]==="'"&&t[t.length-1]==="'"||t[0]==='"'&&t[t.length-1]==='"'?t.substring(1,t.length-1):t}function Zt(t){return/^\s*{(.|\s)*}\s*$/.test(t)}function Qt(t){return/^\s*\[(.|\s)*]\s*$/.test(t)}function jt(t){let e=[];return t.split(/(\r\n|\r|\n)/).map(n=>n.trim()).filter(n=>n).reduce((n,i,r)=>{let c={},o=i.split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(s=>![k,Ge,tt].includes(s.trim()));return r===0?(e=[...o.map(s=>JSON.parse(s))],n):(o.forEach((s,u)=>{c[e[u]]=JSON.parse(s)}),n.push(c),n)},[])}function Nt(t){let e=`return (${t});`,n=new Function(e)();return typeof n=="function"?n():n}var te=new WeakSet,K=!1,xt=(t,e)=>h(e)?function n(i){if(te.has(i))return i;for(let c in i)E(i[c])&&!R(i[c])&&(i[c]=n(i[c]));let r=new Proxy(i,{get(c,o){let s=Reflect.get(i,o);return h(s)&&$t(c)&&N(o)&&o.substring(0,3)==="set"&&h(e)&&(s=function(...u){let m=Reflect.get(c,o).apply(c,u);return!K&&e(t),m}),$t(c)?s.bind(c):s},set(c,o,s){let u,m=c[o]===s;return E(s)&&!R(s)?u=Reflect.set(c,o,n(s)):u=Reflect.set(c,o,s),!K&&!m&&e(t),u},deleteProperty(c,o){let s=Reflect.deleteProperty(c,o);return!K&&e(t),s}});return te.add(r),r}(t):t;xt.stop=()=>K=!0;xt.start=()=>K=!1;var et=xt;var Z=!1,nt=!0;function ze(t){return t===null?null:t.constructor?new t.constructor:{}}function G(t){if(!E(t))return t;let e=t===null?null:Object.assign(ze(t),t);for(let n in e)E(e[n])&&(e[n]=G(e[n]));return e}function ee(t,e){let n=[],i=[];function r(o,s){if(o===null||s===null)return Z;if(h(o.valueOf)&&h(s.valueOf)&&(o!==o.valueOf()||s!==s.valueOf()))return o.valueOf()===s.valueOf()&&o.constructor===s.constructor;if(n.indexOf(o)>-1&&i.indexOf(s)>-1)return nt;let u=Object.keys(o),m=Object.keys(s);if(u.length!==m.length)return Z;if(u.length>0){n.push(o),i.push(s);let p=u.length;for(;p--;){let f=u[p];if(!c(o[f],s[f]))return Z}}return nt}function c(o,s){if(o===s)return nt;let u=typeof o;return u!==typeof s?Z:u===v&&isNaN(o)&&isNaN(s)?nt:u===S?r(o,s):Z}return c(t,e)}function ne(t,e){let n=t,i=N(e)?e.split("."):e;for(let r=0;r<i.length;r++){if(g(n[i[r]]))return;n=n[i[r]]}return n}var rt=globalThis.GRAPHANE_PREFIX||"g-",qe=Symbol(),y=Symbol(),B=Symbol(),w=Symbol(),St=Object.defineProperty;function We(t,e,n,i=!1){if(!(t.ready===!1||!e))if(i)n?t.setAttribute(e,k):t.removeAttribute(e);else{let r=R(n)||g(n)?k:n.toString();t.hasAttribute(e)&&t.getAttribute(e)!==r&&t.setAttribute(e,r)}}function Je(t){this[y]={};let e=t;do{let n=it.get(e);for(let i in n)if(n.hasOwnProperty(i)&&this.hasOwnProperty(i)){let r=this[i];delete this[i],this[i]=g(r)?G(n[i]):r}else i in this[y]||(this[y][i]=G(n[i]));e=Object.getPrototypeOf(e)}while(e!==HTMLElement)}function Ye(){new MutationObserver(t=>{for(let e of t)if(!e.attributeName){this[w]("update");break}(g(this.ready)||this.ready)&&h(this[B])&&this[B](t)}).observe(this,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}var it=new WeakMap,st=class extends HTMLElement{constructor(){super(),Je.call(this,new.target),new.target[qe]?.forEach(e=>h(e)&&e.call(this,this)),h(this[B])&&Ye.call(this)}[w](e,n={},i=!1){return this.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n,composed:i}))}};function Xe(t,e){e.propertyName||(e.propertyName=Xt(e.name)),ie(t,{name:e.propertyName,value:e.value,get:e.get,set:e.set,attribute:e.name,type:e.type,preUpdate:e.preUpdate,posUpdate:e.posUpdate,posUpdateEvent:e.posUpdateEvent,schema:e.schema});let n=Object.getPrototypeOf(t),i="observedAttributes",r=Object.getOwnPropertyDescriptor(t,i),c=Object.getOwnPropertyDescriptor(n,i),o=r?r.get:void 0;St(t,i,Ze(t,e,n,o,r,c));let s="attributeChangedCallback",u=Object.getOwnPropertyDescriptor(t.prototype,s),m=Object.getOwnPropertyDescriptor(n.prototype,s),p=u?u.value:void 0;St(t.prototype,s,Ke(e,p,m))}function Ke(t,e,n){return{value:function(i,r,c){if(t.name===i){let o=t.propertyName;this[o]!==c&&(t.type===V?this[o]=this.hasAttribute(t.name):this[o]=X(c,t.type))}else e&&e.apply(this,arguments);n?.value&&n.value.apply(this,arguments)},enumerable:!1,writable:!0,configurable:!0}}function Ze(t,e,n,i,r,c){let o={enumerable:!1,configurable:!0};return r?c?o.get=function(){return[e.name,...i.call(t),...c.get.call(n)]}:o.get=function(){return[e.name,...i.call(t)]}:o.get=c?function(){return[e.name,...c.get.call(n)]}:function(){return[e.name]},o}function ie(t,e){St(t.prototype,e.name,{set:re(e),get:je(e),configurable:!0,enumerable:!1}),it.has(t)||it.set(t,{}),it.get(t)[e.name]=e.value}function Qe(t,e){R(t.posUpdateEvent)||(t.posUpdateEvent?this[w](t.posUpdateEvent,{[t.name]:e}):this[w]("update",{[t.name]:e})),h(t.posUpdate)?t.posUpdate.call(this,e):h(this[t.posUpdate])&&this[t.posUpdate]()}function re(t){return function(e){let n=this[y];h(t.preUpdate)&&!t.preUpdate.call(this,e)||(t.schema&&(et.stop(),e=t.schema.normalize(e),et.start()),!(!E(e)&&ee(n[t.name],e))&&(h(t.set)?t.set.call(this,e):n[t.name]=N(e)&&t.type?X(e,t.type):e,t.attribute&&![W,S].includes(t.type)&&We(this,t.name,e,t.type===V),Qe.call(this,t,e)))}}function je(t){return function(){if(h(t.get))return t.get.call(this);{let e=this[y];switch(t.type){case v:return g(e[t.name])?void 0:Number(e[t.name]);case V:return!!e[t.name];case S:case W:return et(e[t.name]||(t.type===S?{}:[]),n=>re(t).call(this,n));default:return e[t.name]}}}}function tn(t,e){customElements.get(rt+e.toLowerCase())||customElements.define(rt+e.toLowerCase(),t)}function se(t,e={}){return e.property=(...n)=>(n.forEach(i=>ie(t,{...i})),e),e.attribute=(...n)=>(n.forEach(i=>Xe(t,{...i})),e),e.tag=n=>(tn(t,n),e),e.extension=n=>(n.call(e,e,t),e),e}function oe(t,e){let n=new WeakMap;return function(...i){clearTimeout(n.get(this)),n.set(this,setTimeout(()=>{t.apply(this,i)},e))}}function wt(t,e){let n=new WeakMap,i=[];return function(...r){return clearTimeout(n.get(this)),new Promise((c,o)=>{i.push({resolve:c,reject:o}),n.set(this,setTimeout(()=>{try{let s=t.apply(this,r);i.forEach(u=>u.resolve(s))}catch(s){i.forEach(u=>u.reject(s))}finally{i.length=0}},e))})}}function At(t,e){return function(...n){if(t.apply(this,n))return e.apply(this,n)}}function Tt(t,e){return function(...n){let i=t.apply(this,n);return i instanceof Promise?i.then(r=>e.call(this,r)||r):e.call(this,i)||i}}var ce=1,J=Symbol(),b=Symbol(),ue=Symbol(),bt=Symbol();var H=class extends st{constructor(e){super(),this.attachShadow({mode:"open"}),this[y].ready=e||!1,this[y].rendered=!1,g(e)&&(this.ready=!0)}get ready(){return this[y].ready}set ready(e){let n=this[y],i=n.ready;n.ready=!!e,i===!1&&n.ready===!0&&(this[w]("ready",{ready:!0}),h(this[b])&&this[b]())}get rendered(){return this[y].rendered}set rendered(e){let n=this[y],i=n.rendered;n.rendered=!!e,i===!1&&n.rendered===!0&&this[w]("render",{rendered:!0})}connectedCallback(){let e=this.getBoundingClientRect(),n=getComputedStyle(this).flexDirection,i=()=>{let{width:r,height:c}=this.getBoundingClientRect(),o=getComputedStyle(this).flexDirection;(r!==e.width||c!==e.height||o!==n)&&(h(this[ue])&&this[ue](r,c,r-e.width,c-e.height),e={width:r,height:c},n=o,this[w]("resize",e)),this[y]._resizeObserver=window.requestAnimationFrame(i)};i()}disconnectedCallback(){window.cancelAnimationFrame(this[y]._resizeObserver)}};function en(t,e){let n={name:e.name.startsWith("--")?e.name:`--${rt}${e.name}`,initialValue:e.initialValue??e.value??"",syntax:e.syntax??"*",inherits:e.inherits??!0};t.prototype[bt]||(t.prototype[bt]={}),t.prototype[bt][n.name]=n}function nn(t){if(h(t.prototype[b])){let e=t.prototype[b];t.prototype[b]=At(function(){return this.rendered=!1,this.ready},wt(Tt(async function(){return e.apply(this)},function(n){this.rendered=n!==!1,this.rendered&&h(this[J])&&this[J]()}),ce))}if(h(t.prototype[J])){let e=t.prototype[J];t.prototype[J]=At(function(n){return n&&(this[y].rendered=!0),this.ready&&this[y].rendered},wt(Tt(async function(...n){return e.apply(this,n)},function(){this[w]("refresh")}),ce))}}function ae(t){nn(t);let e=se(t,{style:(...n)=>(n.forEach(i=>en(t,{...i})),e)});return e}H.RENDER=b;H.REFRESH=J;H.CHANGE=B;var rn="enterViewport",sn="exitViewport",ot=Symbol(),on={root:null,rootMargin:"0px",threshold:[0,.5,.1,.15,.2,.25,.3,.35,.4,.45,.5,.55,.6,.65,.7,.75,.8,.85,.9,.95,1]};function cn(t){t.attribute({name:"viewport-once-class",type:L,value:"",posUpdate:Ot}).attribute({name:"viewport-class",type:L,value:"",posUpdate:Ot}).attribute({name:"viewport-ratio",type:v,value:0,posUpdate:Ot})}function fe(t,e){e&&e.split(" ").forEach(n=>t.add(n))}function un(t,e){e&&e.split(" ").forEach(n=>t.remove(n))}function Ot(){let t=this[y],e=this.classList,n=!1;this[ot]&&this[ot].disconnect(),this[ot]=new IntersectionObserver(i=>{i.forEach(r=>{r.isIntersecting&&r.intersectionRatio>=t.viewportRatio?n||(fe(e,t.viewportOnceClass),fe(e,t.viewportClass),n=!0,this[w](rn)):n&&(un(e,t.viewportClass),n=!1,this[w](sn))})},on),this[ot].observe(this)}var le=cn;var Lt="gSVGObject",an="http://www.w3.org/2000/svg",fn="svg",vt="d",he="transform",pe="appendChild",Pt="insertBefore",de="insertAdjacentElement",me="attach",ye="innerHTML",Rt=new WeakMap,_t=new Set,ln=t=>Jt(t)||t.startsWith("_")||["el","gSVG","then"].includes(t),ct=(t,e)=>t instanceof e,hn=()=>Lt+Math.random().toString(32).substring(2),It=t=>E(t)&&!R(t)&&t[Symbol.toStringTag]===Lt,dn=t=>ht(document.createElementNS(an,t)),ut=t=>N(t)?dn(t):E(t)&&t!==null?It(t)?t:ht(t):t,pn=t=>({content:ye,source:"outerHTML",parent:"parentElement",next:"nextElementSibling",previous:"previousElementSibling",add:pe,addBefore:Pt})[t]||t,mn=t=>["append","before","after",pe,Pt,de].includes(t)?function(...e){let n=[],i=[],r=[];return t===de?(n.push(e[0]),i.push(ut(e[1]))):t===Pt?(i.push(ut(e[0])),r.push(e[1]||this.firstChild||null)):i.push(...e.map(ut)),i.every(c=>c?._el)?(this[t](...n,...i.map(c=>c&&c._el),...r),i.forEach(c=>c._el.dispatchEvent(new Event(me))),i.length>1?i:i[0]):i[0]}:null,lt=class{constructor(e){this._el=e,this.gSVG=z}get[Symbol.toStringTag](){return Lt}get el(){return this._el}attachTo(e){return(E(e)?It(e)?e._el:e:document.querySelector(e)).appendChild(this._el),this._el.dispatchEvent(new Event(me)),this}id(e){return e?(this._el.setAttribute("id",e),this):this._el.id||(this._el.id=hn())}ref(){return`#${this.id()}`}url(){return`url(${this.ref()})`}parents(){let e=[],n=this;for(;n=n.parentElement();)e.push(n);return e}top(){return this.parents().pop()||this}},ht=t=>{if(!E(t)||R(t))return null;if(Rt.has(t))return Rt.get(t);let e=new Proxy(new lt(t),{get(n,i){if(ln(i))return n[i];if(!g(n[i]))return(...o)=>(C(e,i,o),n[i].call(e,...o));if([vt,he,"$"+vt,"$"+he].includes(i)){let o="";i[0]==="$"&&(i=i.substring(1));let u=i===vt?yn:gn,m=new Proxy(p=>(C(e,i,[p]),g(p)?t.getAttribute(i):(p?t.setAttribute(i,p):t.removeAttribute(i),e)),{get(p,f){return f in p?Reflect.get(p,f):(...$)=>{if(f===Symbol.toPrimitive){let F=o;return o="",F}return o+=u(e,f,$),t?.setAttribute(i,o),m}}});return m}let r=pn(i),c=mn(r)||t[r];return h(c)?(...o)=>{C(e,i,o);let s=c.call(t,...o);return g(s)?e:Ee(s)}:ge(t,r,e)}});return Rt.set(t,e),e},ge=(t,e,n,i)=>{let r=e.replace(/_/g,"-"),c=(...o)=>{if(C(n,i?`${i}.${e}`:e,o),o.length===0){let u=t?.hasAttribute&&t.hasAttribute(r)?t.getAttribute(r):t[r];return Ee(u)}let s=o[0];if(ct(t,CSSStyleDeclaration))return t[r]=s,n;if(r in t&&!_t.has(r)){let u=t[r];if(String(u)===String(s))return n;try{t[r]=s}catch{_t.add(r)}if(E(t[r])&&t[r]===s||t[r]!==u||r===ye)return n;_t.add(r)}return s!==0&&!s?t?.removeAttribute&&t.removeAttribute(r):t?.setAttribute&&t.setAttribute(r,Yt(s)?"":String(o)),n};return new Proxy(c,{get(o,s){let u=t[r][s];return h(u)?(...m)=>(C(n,`${e}.${s}`,m),u.call(t[r],...m)||n):ge(t[r],s,n,r)},set(o,s,u){return t[r][s]=u,!0}})},Ee=t=>ct(t,HTMLCollection)||ct(t,NodeList)?[...t].map(e=>ht(e)):ct(t,SVGElement)?ht(t):N(t)?t===""||Number.isNaN(Number(t))?t:Number(t):t,$e=[],C=(t,e,n,i=[])=>{for(let r of $e)r(z,t,e,n,i)},at={},yn=(t,e,n)=>(C(t,`d.${e}`,n,Object.keys(at).map(i=>`d.${i}`)),at[e]?at[e].apply(t,n):`${e}${n.join(tt)}`),gn=(t,e,n)=>(C(t,`transform.${e}`,n),`${e}(${n.join(tt)})`);function z(t){return C(null,k,[t]),ut(g(t)?fn:t)}z.isWrapped=It;var ft=t=>e=>h(e)?e(t):Object.assign(t,e),Mt={install:Ne,extendConstructor:ft(z),extendInstance:ft(lt.prototype),extendPath:ft(at),beforeEveryCall(t){h(t)&&$e.push(t)}};Mt.extendSetup=ft(Mt);function Ne(t){return t(Mt),z}z.install=Ne;var dt=z;var Ut=new Map,En=/function\s+([\p{L}\p{Nl}$_][\p{L}\p{Nl}$_\p{Mn}\p{Mc}\p{Nd}\p{Pc}]*)\s*\(/gmu,$n=async function(){}.constructor;function pt(t,e,n=!1){let i=`${t.join(",")} ${e}`;if(Ut.has(i))return Ut.get(i);let r=new(n?$n:Function)(...t,e);return Ut.set(i,r),r}function xe(t,e){let n=[...e.matchAll(En)].map(i=>i[1]);try{return pt(Object.keys(t),`${e}; return {${n.map(r=>`${r}: typeof ${r} === 'function' ? ${r} : undefined`)}}; `)(...Object.values(t))}catch(i){console.warn(i.message,` `,e)}}function Ct(t){try{return new Function(`let ${t} = 0`),!0}catch{return!1}}var Se="SVG",Dt="animate",Nn="none",xn="freeze",Sn="path",we="d",Ae="transform",ve="rotate",Ft="translate",wn="offset",Te="inherit",be="finished",An=[ve,"skewX","skewY"],Tn="deg",Q="px",Oe="ms",bn=["width","height"],Vt=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");Vt=t.matches,t.addEventListener("change",()=>{Vt=t.matches})}var On=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function vn(t,e={duration:200},n=null,i=null){let r=this.gSVG,c=a=>{let d=E(a)?{...a}:{duration:a};return Vt&&(d.duration=0),d.fill=Nn,d},o=a=>{a=U(a)?a:[a];let d=window.getComputedStyle(this._el),l=[],x=new Set;for(let M of a){let O={...M};for(let A in O)!(A in d)||bn.includes(A)?x.add(A):A===we?O.d=`${Sn}("${O.d}")`:A===Ae&&(O.transform=m(O.transform));l.push(O)}return u(x,l),l},s=[],u=(a,d)=>{if(a.size){let l=new KeyframeEffect(null,d).getKeyframes(),x=this.closest(Se)?this.closest(Se).getCurrentTime()*1e3:0;for(let M of a){let O=r(Dt).attributeName(M).dur(_.duration+Oe).begin((0|x+(e.delay||0))+Oe).fill(xn);if(d.length===1)O.to(d[0][M]);else{let A=[],j=[];for(let Et in l){let De=l[Et];M in d[Et]&&(A.push(De.computedOffset),j.push(d[Et][M]))}A[0]!==0&&(A.unshift(0),j.unshift(this[M]()||Te)),A[A.length-1]!==1&&(A.push(1),j.push(this[M]()||Te)),O.keyTimes(A.join(";")).values(j.join(";"))}s.push(O),O.attachTo(this)}}},m=a=>{N(a)&&(a=JSON.parse("{"+a.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let d="";for(let l in a)if(l===ve){let x=p(a[l]);x.length>1&&(d+=`${Ft}(${x[1]}${Q},${x[2]}${Q}) `),d+=`${l}(${x[0]}${f(l)}) `,x.length>1&&(d+=`${Ft}(-${x[1]}${Q},-${x[2]}${Q}) `)}else d+=`${l}(${p(a[l]).map(x=>x+f(l)).join(",")}) `;return d},p=a=>U(a)?a:String(a).split(/\s+|,/),f=a=>An.includes(a)?Tn:a===Ft?Q:"",$=a=>N(a)?a.replace(/(deg)|(px)/g,"").trim():a,F=a=>a.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),I=a=>{let d=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,l=d.exec(a);return l&&Number(l[1])===Number(l[4])*-1&&Number(l[2])===Number(l[5])*-1?a=a.replace(d,`rotate(${l[3]}, ${l[1]}, ${l[2]})`):a=$(a),a},_=c(e),P=o(t),T=this._el.animate(P,_);return T.ready.then(()=>h(n)&&n.call(this,T)),T.finished.then(()=>{let a=P[P.length-1];for(let d in a){let l=On(d);l.startsWith("text-")?this._el.style[d]=a[d]:d!==wn&&d in a&&this._el.setAttribute(l,l===we?F(a[d]):l===Ae?I(a[d]):$(a[d]))}s.forEach(d=>{d[be](!0);let l=this._el.querySelectorAll(Dt),x=this._el.querySelectorAll(`${Dt}[${be}]`);l.length===x.length&&l.forEach(M=>M.remove())}),h(i)&&i.call(this,T)}),this}function Re(t){t.extendInstance({animateTo:vn})}var _e=Symbol(),Pe=Symbol(),q=Symbol(),mt=Symbol(),yt=Symbol(),Rn="unknown",Me="Graphane SVG Template Engine:",kt=[];Y({name:"g-content",execute(t,{expression:e,data:n,evalExpression:i}){t.content(i(e,n))}});Y({name:"g-if",execute(t,{expression:e,data:n,evalExpression:i}){t.style.visibility(i(e,n)?"inherit":"hidden")}});Y({name:"g-bind",alias:":",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:r}){let c={...i,$$:["d","transform"].includes(n)?t["$"+n]:()=>t[n]()};c.$$.dynamic=(s,u=200,m=0)=>{t.animateTo((U(s)?s:[s]).map(p=>E(p)&&"offset"in p?{[n]:p.value,offset:p.offset}:{[n]:p}),{duration:u,delay:m})};let o=r(e,c);if(n==="class"){if(U(o)){t.classList.add(...o.filter(s=>!!s));return}if(E(o)){Object.entries(o).forEach(([s,u])=>{u?t.classList.add(s):t.classList.remove(s)});return}o&&t.classList.add(o);return}if(n==="style"){Object.entries(o).forEach(([s,u])=>t.style[s](u));return}g(o)||t[n](o)}});Y({name:"g-on",alias:"@",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:r}){t[yt]=t[yt]||{};let c=t[yt][n]=t[yt][n]||new Map;c.has(e)&&t.removeEventListener(n,c.get(e));let o=function(s){let u=r(e,i,t);h(u)&&u.call(t,s)};t.addEventListener(n,o),c.set(e,o),n==="init"&&!t[_e]&&(t[_e]=!0,t.dispatchEvent(new Event("init")))}});Y({name:"g-for",template:!0,execute(t,{expression:e,data:n}){t[q]=t[q]||[];let i=0;Ln(e,n,r=>{if(t[q][i])gt(t[q][i],r,!1);else{let c=t.gSVG("g");t.children().forEach(o=>{c.add(o.cloneNode(!0))}),gt(c,r),t.before(c.el),c[Pe]=!0,t[q].push(c)}i++},r=>{for(;t[q].length>r.length;)t[q].pop().remove()})}});function Y({name:t,alias:e,argument:n,template:i,execute:r}){let c=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,o=new RegExp(c,"i");kt.push({name:t,alias:e,argument:n,template:i,execute:r,check:o})}function _n(t){for(let e of kt){let n=e.check.exec(t);if(n){let i=n[2];return{...e,argument:i}}}}function Pn(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>e.includes(":")?e.split(":")[1]:e).map(e=>e.trim())}function Mn(t){return t[Symbol.iterator]?{iterator:[...t],type:W}:Wt(t)?{iterator:Array(t<0?0:0|t).fill(0).map((e,n)=>n),type:v}:E(t)?{iterator:Object.entries(t).map(e=>e.reverse()),type:S}:{iterator:t,type:Rn}}function Le(t,e,n=null){try{let i=Object.keys(e).filter(Ct);return pt(i,`return ( ${t} ); `).apply(n,i.map(c=>e[c]))}catch(i){console.warn(Me,i.message,` `,t)}}function Ln(t,e,n,i){let r="__$$iterator",c="__$$callback",o="__$$final";try{let[s,u]=t.split(" of ");s=s.trim(),u=u.trim();let m=Le(u,e)||[],{iterator:p,type:f}=Mn(m);f===S&&!s.startsWith("[")&&(s=`[${s.replace(/(^\()|(\)$)/g,"")}]`);let $=Pn(s),F=s.startsWith("(")?s:`(${s})`,I=Object.keys(e).filter(Ct),_=` ${r}.forEach(${F} => { ${c}({${I}${I.length?",":""}${$.join(",")}}); }); ${o}(${r}); `;return pt([...I,r,c,o],_)(...I.map(T=>e[T]),p,n,i)}catch(s){console.warn(Me,s)}}function gt(t,e,n=!0){if(n&&t[Pe])return;t[mt]=t[mt]||[];let i=t.attributes();for(let c of[...i]){let o=c.name,s=_n(o);s&&(t[mt].push({...s,expression:c.value}),t.removeAttribute(o))}let r=!1;for(let c of t[mt])c.execute(t,{...c,data:e,evalExpression:Le}),r=c.template||r;if(!r)for(let c of t.children())gt(c,e)}function In(t={}){gt(this,t),this.dispatchEvent(new Event("render"))}function Ie(t){t.install(Re),t.extendInstance({render:In}),t.extendSetup({extendTemplate:{defineDirective:Y,obtainDirective(e){return kt.find(n=>n.name===e)}}})}var Bt=Symbol(),Gt=Symbol();function Un(t,e){return e===Bt?t:ne(t,e)}function Ue(t={}){let e={};function n(f,$,F,I){return e[f]||(e[f]={}),(_=void 0,P=Bt)=>{if(N(_)||g(_)){if(P=_||Bt,P in e[f])return e[f][P]}else t=_;let T=t.reduce((a,d)=>{let l=Un(d,P);return typeof l>"u"?a:a===Gt?l:F(a,l)},$);return T=typeof I=="function"?I(T):T,t!==_&&(e[f][P]=T),T}}let i=n("min",Gt,(f,$)=>$>f?f:$),r=n("max",Gt,(f,$)=>$<f?f:$),c=n("count",0,f=>f+1),o=n("sum",0,(f,$)=>$+f),s=n("avg",{n:0,i:0},(f,$)=>(f.n++,f.i+=Number($),f),f=>f.i/f.n),u=n("distinct",new Set,(f,$)=>(f.add($),f),f=>[...f]),m={},p={enumerable:!1,configurable:!0,writable:!0};return"$min"in t||(m.$min={value:i,...p}),"$max"in t||(m.$max={value:r,...p}),"$sum"in t||(m.$sum={value:o,...p}),"$count"in t||(m.$count={value:c,...p}),"$avg"in t||(m.$avg={value:s,...p}),"$distinct"in t||(m.$distinct={value:u,...p}),Object.defineProperties(t,m)}var Cn=t=>{t.extendSetup({extendComposer(e){h(e)?e(D.prototype):Object.assign(D.prototype,e)}})};dt.install(Ie).install(Cn);var Dn="composer",Ht="update",zt="SVG",Ce=t=>`script[type=${t}],g-script[type=${t}]`,D=class extends H{#t=null;#e=!1;isRendering=!1;async#i(e){let n=await fetch(e);if(n.status!==200)throw new Error(`${n.statusText} (${n.status}): ${n.url}`);return n.text()}async#u(){let e=[...this.querySelectorAll(Ce("plugin"))];for(let n of e){let i=n.getAttribute("src");i&&dt.install((await import(i))?.svgPlugin)}}async#r(){let e=this[y];if(this.#t=null,e.content.innerHTML="",e.svgSrc)e.content.innerHTML=await this.#i(e.svgSrc);else{let i=this.querySelector("template")?.content||this.querySelector(zt);i&&e.content.append(i.cloneNode(!0))}let n=e.content.querySelector(zt);return n&&(this.#t=dt(n),(!this.#t.width()||this.#t.width()?.baseVal?.value===0)&&this.#t.width("100%")),!0}async#n(e){let n=this[y],i=e+"Src",r=this.querySelector(Ce(e));return r&&(n[i]=r.getAttribute("src")),n[i]?this.#i(n[i]):r?.textContent}async#s(){let e=await this.#n("methods");e&&(this[y].methods=xe({$:this},e))}async#o(){let e=await this.#n("config");e&&(this[y].config=Nt(e))}async#c(){let e=await this.#n("data");e&&(this[y].data=Zt(e)||Qt(e)?Nt(e):jt(e))}constructor(){super();let e=this[y];this.shadowRoot.innerHTML=` <style> :host { display : inline-block; width : max-content; height : max-content; } </style><span id="content"></span> `,e.content=this.shadowRoot.querySelector("#content")}[b](){return this.load()}async[B](e){let n=[];try{for(let i of e){let r=i.target;if(r===this&&!i.attributeName)return this.load();if(r.tagName===zt)n.push(this.#r());else if(r.tagName==="SCRIPT"){let c={data:this.#c,methods:this.#s,config:this.#o}[r.type.toLowerCase()];c&&n.push(c())}}}catch(i){return console.error(i.message),this[w]("error",i.message),!1}if(n.length)return await Promise.all(n),this.update()}async load(){try{this.#e=!1,await this.#u(),await Promise.all([this.#r(),this.#o(),this.#s(),this.#c()]),this.#e=!0}catch(e){return console.error(e.message),this[w]("error",e.message),!1}return this.update(!0)}async update(e=!1){if(!(this.isRendering&&!e)&&this.#t){this.isRendering=!0;let n=this[y],i=Ue(n.methods.data?n.methods.data(G(n.data)):G(n.data)),r={...n.methods,...U(i)?{}:i,data:i,$:this};await this.#t.render(r),this.isRendering=!1}}get svg(){return this.#t}get loaded(){return this.#e}};D.prototype.update=oe(D.prototype.update,1);ae(D).extension(le).attribute({name:"svg-src",type:L,value:"",posUpdate:b}).attribute({name:"data",type:S,value:[],posUpdate:Ht}).attribute({name:"data-src",type:L,posUpdate:b}).property({name:"methods",type:S,value:{},posUpdate:Ht}).attribute({name:"methods-src",type:L,posUpdate:b}).attribute({name:"config",type:S,value:{},posUpdate:Ht}).attribute({name:"config-src",type:L,posUpdate:b}).tag(Dn);})(); //# sourceMappingURL=composer.js.map