/* graphane - 0.1.0-alpha.5 */ (()=>{var Ce="function",Ht="undefined",x="object",L="string",z="array",R="number",F="boolean",De="date",Fe="symbol",V="",j=",";var Ve=";",E=t=>typeof t===x,S=t=>typeof t===L,l=t=>typeof t===Ce,zt=t=>typeof t===R&&!isNaN(t),g=t=>typeof t===Ht,qt=t=>typeof t===Fe,Jt=t=>typeof t===F,I=t=>Array.isArray(t),Et=t=>t instanceof Date&&!isNaN(t),_=t=>t===null,Yt=t=>t.replace(/-([a-z0-9])/g,(e,n)=>n.toUpperCase());function ke(t){if(S(t))try{let e=t.replace(/^\s*{/,"").replace(/}\s*$/,"").split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(n=>!["",";",","].includes(n.trim())).map(n=>n.split(":")).map(n=>`"${n[0].trim()}":${Y(n[1].trim(),void 0,!0)}`).join(",");return JSON.parse(`{${e}}`)}catch(e){console.error(e);return}else if(E(t))return t}function Xt(t){if(S(t))return t.trim()[0]==="["?(t.match(/\[(.*?)[^\]]]/g)||[]).map(e=>Xt(e.substring(1,e.length-1))):t.split(/[,;]/).map(e=>Y(e.trim()));if(I(t))return t}function Y(t,e,n=!1){if(!S(t))return t;if(t=Ge(t.trim()),e===z)return Xt(t);if(e===x)return ke(t);if(g(e)||e===R){if(g(t)||t==="")return;let i=+t;if(!Number.isNaN(i)||e===R)return i}if(g(e)||e===F){if(t==="true")return!0;if(t==="false")return!1;if(e===F)return t==="0"?!1:!!t}if(e===De){try{let i=new Date(t);if(!Number.isNaN(i.getTime()))return i}catch{}return}if(g(e)||e===L)return n?`"${t}"`:t}function Ge(t){return t[0]==="'"&&t[t.length-1]==="'"||t[0]==='"'&&t[t.length-1]==='"'?t.substring(1,t.length-1):t}function Wt(t){return/^\s*{(.|\s)*}\s*$/.test(t)}function Kt(t){return/^\s*\[(.|\s)*]\s*$/.test(t)}function Zt(t){let e=[];return t.split(/(\r\n|\r|\n)/).map(n=>n.trim()).filter(n=>n).reduce((n,i,r)=>{let c={},o=i.split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(s=>![V,Ve,j].includes(s.trim()));return r===0?(e=[...o.map(s=>JSON.parse(s))],n):(o.forEach((s,u)=>{c[e[u]]=JSON.parse(s)}),n.push(c),n)},[])}function $t(t){let e=`return (${t});`,n=new Function(e)();return typeof n=="function"?n():n}var Qt=new WeakSet,X=!1,Nt=(t,e)=>l(e)?function n(i){if(Qt.has(i))return i;for(let c in i)E(i[c])&&!_(i[c])&&(i[c]=n(i[c]));let r=new Proxy(i,{get(c,o){let s=Reflect.get(i,o);return l(s)&&Et(c)&&S(o)&&o.substring(0,3)==="set"&&l(e)&&(s=function(...u){let p=Reflect.get(c,o).apply(c,u);return!X&&e(t),p}),Et(c)?s.bind(c):s},set(c,o,s){let u,p=c[o]===s;return E(s)&&!_(s)?u=Reflect.set(c,o,n(s)):u=Reflect.set(c,o,s),!X&&!p&&e(t),u},deleteProperty(c,o){let s=Reflect.deleteProperty(c,o);return!X&&e(t),s}});return Qt.add(r),r}(t):t;Nt.stop=()=>X=!0;Nt.start=()=>X=!1;var tt=Nt;var W=!1,et=!0;function Be(t){return t===null?null:t.constructor?new t.constructor:{}}function k(t){if(!E(t))return t;let e=t===null?null:Object.assign(Be(t),t);for(let n in e)E(e[n])&&(e[n]=k(e[n]));return e}function jt(t,e){let n=[],i=[];function r(o,s){if(o===null||s===null)return W;if(l(o.valueOf)&&l(s.valueOf)&&(o!==o.valueOf()||s!==s.valueOf()))return o.valueOf()===s.valueOf()&&o.constructor===s.constructor;if(n.indexOf(o)>-1&&i.indexOf(s)>-1)return et;let u=Object.keys(o),p=Object.keys(s);if(u.length!==p.length)return W;if(u.length>0){n.push(o),i.push(s);let d=u.length;for(;d--;){let a=u[d];if(!c(o[a],s[a]))return W}}return et}function c(o,s){if(o===s)return et;let u=typeof o;return u!==typeof s?W:u===R&&isNaN(o)&&isNaN(s)?et:u===x?r(o,s):W}return c(t,e)}function te(t,e){let n=t,i=S(e)?e.split("."):e;for(let r=0;r<i.length;r++){if(g(n[i[r]]))return;n=n[i[r]]}return n}var it=globalThis.GRAPHANE_PREFIX||"g-",He=Symbol(),m=Symbol(),K=Symbol(),w=Symbol(),St=Object.defineProperty;function ze(t,e,n,i=!1){if(!(t.ready===!1||!e))if(i)n?t.setAttribute(e,V):t.removeAttribute(e);else{let r=_(n)||g(n)?V:n.toString();t.hasAttribute(e)&&t.getAttribute(e)!==r&&t.setAttribute(e,r)}}function qe(t){this[m]={};let e=t;do{let n=nt.get(e);for(let i in n)if(n.hasOwnProperty(i)&&this.hasOwnProperty(i)){let r=this[i];delete this[i],this[i]=g(r)?k(n[i]):r}else i in this[m]||(this[m][i]=k(n[i]));e=Object.getPrototypeOf(e)}while(e!==HTMLElement)}function Je(){new MutationObserver(t=>{for(let e of t)if(!e.attributeName){this[w]("update");break}(g(this.ready)||this.ready)&&l(this[K])&&this[K](t)}).observe(this,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}var nt=new WeakMap,rt=class extends HTMLElement{constructor(){super(),qe.call(this,new.target),new.target[He]?.forEach(e=>l(e)&&e.call(this,this)),l(this[K])&&Je.call(this)}[w](e,n={},i=!1){return this.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n,composed:i}))}};function Ye(t,e){e.propertyName||(e.propertyName=Yt(e.name)),ee(t,{name:e.propertyName,value:e.value,get:e.get,set:e.set,attribute:e.name,type:e.type,preUpdate:e.preUpdate,posUpdate:e.posUpdate,posUpdateEvent:e.posUpdateEvent,schema:e.schema});let n=Object.getPrototypeOf(t),i="observedAttributes",r=Object.getOwnPropertyDescriptor(t,i),c=Object.getOwnPropertyDescriptor(n,i),o=r?r.get:void 0;St(t,i,We(t,e,n,o,r,c));let s="attributeChangedCallback",u=Object.getOwnPropertyDescriptor(t.prototype,s),p=Object.getOwnPropertyDescriptor(n.prototype,s),d=u?u.value:void 0;St(t.prototype,s,Xe(e,d,p))}function Xe(t,e,n){return{value:function(i,r,c){if(t.name===i){let o=t.propertyName;this[o]!==c&&(t.type===F?this[o]=this.hasAttribute(t.name):this[o]=Y(c,t.type))}else e&&e.apply(this,arguments);n?.value&&n.value.apply(this,arguments)},enumerable:!1,writable:!0,configurable:!0}}function We(t,e,n,i,r,c){let o={enumerable:!1,configurable:!0};return r?c?o.get=function(){return[e.name,...i.call(t),...c.get.call(n)]}:o.get=function(){return[e.name,...i.call(t)]}:c?o.get=function(){return[e.name,...c.get.call(n)]}:o.get=function(){return[e.name]},o}function ee(t,e){St(t.prototype,e.name,{set:ne(e),get:Ze(e),configurable:!0,enumerable:!1}),nt.has(t)||nt.set(t,{}),nt.get(t)[e.name]=e.value}function Ke(t,e){_(t.posUpdateEvent)||(t.posUpdateEvent?this[w](t.posUpdateEvent,{[t.name]:e}):this[w]("update",{[t.name]:e})),l(t.posUpdate)?t.posUpdate.call(this,e):l(this[t.posUpdate])&&this[t.posUpdate]()}function ne(t){return function(e){let n=this[m];l(t.preUpdate)&&!t.preUpdate.call(this,e)||(t.schema&&(tt.stop(),e=t.schema.normalize(e),tt.start()),!(!E(e)&&jt(n[t.name],e))&&(l(t.set)?t.set.call(this,e):S(e)&&t.type?n[t.name]=Y(e,t.type):n[t.name]=e,t.attribute&&![z,x].includes(t.type)&&ze(this,t.name,e,t.type===F),Ke.call(this,t,e)))}}function Ze(t){return function(){if(l(t.get))return t.get.call(this);{let e=this[m];switch(t.type){case R:return g(e[t.name])?void 0:Number(e[t.name]);case F:return!!e[t.name];case x:case z:return tt(e[t.name]||(t.type===x?{}:[]),n=>ne(t).call(this,n));default:return e[t.name]}}}}function Qe(t,e){customElements.get(it+e.toLowerCase())||customElements.define(it+e.toLowerCase(),t)}function ie(t,e={}){return e.property=(...n)=>(n.forEach(i=>ee(t,Object.assign({},i))),e),e.attribute=(...n)=>(n.forEach(i=>Ye(t,Object.assign({},i))),e),e.tag=n=>(Qe(t,n),e),e.extension=n=>(n.call(e,e,t),e),e}function re(t,e){let n=new WeakMap;return function(...i){clearTimeout(n.get(this)),n.set(this,setTimeout(()=>{t.apply(this,i)},e))}}function xt(t,e){let n=new WeakMap,i=[];return function(...r){return clearTimeout(n.get(this)),new Promise((c,o)=>{i.push({resolve:c,reject:o}),n.set(this,setTimeout(()=>{try{let s=t.apply(this,r);i.forEach(u=>u.resolve(s))}catch(s){i.forEach(u=>u.reject(s))}finally{i.length=0}},e))})}}function wt(t,e){return function(...n){if(t.apply(this,n))return e.apply(this,n)}}function At(t,e){return function(...n){let i=t.apply(this,n);return i instanceof Promise?i.then(r=>e.call(this,r)||r):e.call(this,i)||i}}var se=1,q=Symbol(),T=Symbol(),oe=Symbol(),Tt=Symbol();var G=class extends rt{constructor(e){super(),this.attachShadow({mode:"open"}),this[m].ready=e||!1,this[m].rendered=!1,g(e)&&(this.ready=!0)}get ready(){return this[m].ready}set ready(e){let n=this[m],i=n.ready;n.ready=!!e,i===!1&&n.ready===!0&&(this[w]("ready",{ready:!0}),l(this[T])&&this[T]())}get rendered(){return this[m].rendered}set rendered(e){let n=this[m],i=n.rendered;n.rendered=!!e,i===!1&&n.rendered===!0&&this[w]("render",{rendered:!0})}connectedCallback(){let e=this.getBoundingClientRect(),n=getComputedStyle(this).flexDirection,i=()=>{let{width:r,height:c}=this.getBoundingClientRect(),o=getComputedStyle(this).flexDirection;(r!==e.width||c!==e.height||o!==n)&&(l(this[oe])&&this[oe](r,c,r-e.width,c-e.height),e={width:r,height:c},n=o,this[w]("resize",e)),this[m]._resizeObserver=window.requestAnimationFrame(i)};i()}disconnectedCallback(){window.cancelAnimationFrame(this[m]._resizeObserver)}};function je(t,e){let n={name:e.name.substring(0,2)==="--"?e.name:`--${it}${e.name}`,initialValue:e.initialValue??e.value??"",syntax:e.syntax??"*",inherits:e.inherits??!0};t.prototype[Tt]||(t.prototype[Tt]={}),t.prototype[Tt][n.name]=n}function tn(t){if(l(t.prototype[T])){let e=t.prototype[T];t.prototype[T]=wt(function(){return this.rendered=!1,this.ready},xt(At(async function(){return e.apply(this)},function(n){this.rendered=n!==!1,this.rendered&&l(this[q])&&this[q]()}),se))}if(l(t.prototype[q])){let e=t.prototype[q];t.prototype[q]=wt(function(n){return n&&(this[m].rendered=!0),this.ready&&this[m].rendered},xt(At(async function(...n){return e.apply(this,n)},function(){this[w]("refresh")}),se))}}function ce(t){tn(t);let e=ie(t,{style:(...n)=>(n.forEach(i=>je(t,Object.assign({},i))),e)});return e}G.RENDER=T;G.REFRESH=q;G.CHANGE=K;var en="enterViewport",nn="exitViewport",st=Symbol(),rn={root:null,rootMargin:"0px",threshold:[0,.5,.1,.15,.2,.25,.3,.35,.4,.45,.5,.55,.6,.65,.7,.75,.8,.85,.9,.95,1]};function sn(t){t.attribute({name:"viewport-once-class",type:L,value:"",posUpdate:bt}).attribute({name:"viewport-class",type:L,value:"",posUpdate:bt}).attribute({name:"viewport-ratio",type:R,value:0,posUpdate:bt})}function ue(t,e){e&&e.split(" ").forEach(n=>t.add(n))}function on(t,e){e&&e.split(" ").forEach(n=>t.remove(n))}function bt(){let t=this[m],e=this.classList,n=!1;this[st]&&this[st].disconnect(),this[st]=new IntersectionObserver(i=>{i.forEach(r=>{r.isIntersecting&&r.intersectionRatio>=t.viewportRatio?n||(ue(e,t.viewportOnceClass),ue(e,t.viewportClass),n=!0,this[w](en)):n&&(on(e,t.viewportClass),n=!1,this[w](nn))})},rn),this[st].observe(this)}var fe=sn;var Mt="gSVGObject",cn="http://www.w3.org/2000/svg",un="svg",Ot="d",ae="transform",he="appendChild",_t="insertBefore",le="insertAdjacentElement",de="attach",pe="innerHTML",vt=new WeakMap,Rt=new Set,fn=t=>t[0]==="_"||qt(t)||["el","gSVG","then"].includes(t),ot=(t,e)=>t instanceof e,an=()=>Mt+Math.random().toString(32).substring(2),Lt=t=>E(t)&&!_(t)&&t[Symbol.toStringTag]===Mt,ln=t=>lt(document.createElementNS(cn,t)),ct=t=>S(t)?ln(t):E(t)&&t!==null?Lt(t)?t:lt(t):t,hn=t=>({content:pe,source:"outerHTML",parent:"parentElement",next:"nextElementSibling",previous:"previousElementSibling",add:he,addBefore:_t})[t]||t,dn=t=>["append","before","after",he,_t,le].includes(t)?function(...e){let n=[],i=[],r=[];return t===le?(n.push(e[0]),i.push(ct(e[1]))):t===_t?(i.push(ct(e[0])),r.push(e[1]||this.firstChild||null)):i.push(...e.map(ct)),i.every(c=>c?._el)?(this[t](...n,...i.map(c=>c&&c._el),...r),i.forEach(c=>c._el.dispatchEvent(new Event(de))),i.length>1?i:i[0]):i[0]}:null,at=class{constructor(e){this._el=e,this.gSVG=B}get[Symbol.toStringTag](){return Mt}get el(){return this._el}attachTo(e){return(E(e)?Lt(e)?e._el:e:document.querySelector(e)).appendChild(this._el),this._el.dispatchEvent(new Event(de)),this}id(e){return e?(this._el.setAttribute("id",e),this):this._el.id||(this._el.id=an())}ref(){return`#${this.id()}`}url(){return`url(${this.ref()})`}parents(){let e=[],n=this;for(;n=n.parentElement();)e.push(n);return e}top(){return this.parents().pop()||this}},lt=t=>{if(!E(t)||_(t))return null;if(vt.has(t))return vt.get(t);let e=new Proxy(new at(t),{get(n,i){if(fn(i))return n[i];if(!g(n[i]))return(...o)=>(U(e,i,o),n[i].call(e,...o));if([Ot,ae,"$"+Ot,"$"+ae].includes(i)){let o="";i[0]==="$"&&(i=i.substring(1));let u=i===Ot?pn:mn,p=new Proxy(d=>(U(e,i,[d]),g(d)?t.getAttribute(i):(d?t.setAttribute(i,d):t.removeAttribute(i),e)),{get(d,a){return a in d?Reflect.get(d,a):(...N)=>{if(a===Symbol.toPrimitive){let D=o;return o="",D}return o+=u(e,a,N),t?.setAttribute(i,o),p}}});return p}let r=hn(i),c=dn(r)||t[r];return l(c)?(...o)=>{U(e,i,o);let s=c.call(t,...o);return g(s)?e:ye(s)}:me(t,r,e)}});return vt.set(t,e),e},me=(t,e,n,i)=>{let r=e.replace(/_/g,"-"),c=(...o)=>{if(U(n,i?`${i}.${e}`:e,o),o.length===0){let u=t?.hasAttribute&&t.hasAttribute(r)?t.getAttribute(r):t[r];return ye(u)}let s=o[0];if(ot(t,CSSStyleDeclaration))return t[r]=s,n;if(r in t&&!Rt.has(r)){let u=t[r];if(String(u)===String(s))return n;try{t[r]=s}catch{Rt.add(r)}if(E(t[r])&&t[r]===s||t[r]!==u||r===pe)return n;Rt.add(r)}return s!==0&&!s?t?.removeAttribute&&t.removeAttribute(r):t?.setAttribute&&t.setAttribute(r,Jt(s)?"":String(o)),n};return new Proxy(c,{get(o,s){let u=t[r][s];return l(u)?(...p)=>(U(n,`${e}.${s}`,p),u.call(t[r],...p)||n):me(t[r],s,n,r)},set(o,s,u){return t[r][s]=u,!0}})},ye=t=>ot(t,HTMLCollection)||ot(t,NodeList)?[...t].map(e=>lt(e)):ot(t,SVGElement)?lt(t):S(t)?t===""||Number.isNaN(Number(t))?t:Number(t):t,ge=[],U=(t,e,n,i=[])=>{for(let r of ge)r(B,t,e,n,i)},ut={},pn=(t,e,n)=>(U(t,`d.${e}`,n,Object.keys(ut).map(i=>`d.${i}`)),ut[e]?ut[e].apply(t,n):`${e}${n.join(j)}`),mn=(t,e,n)=>(U(t,`transform.${e}`,n),`${e}(${n.join(j)})`);function B(t){return U(null,V,[t]),ct(g(t)?un:t)}B.isWrapped=Lt;var ft=t=>e=>l(e)?e(t):Object.assign(t,e),Pt={install:Ee,extendConstructor:ft(B),extendInstance:ft(at.prototype),extendPath:ft(ut),beforeEveryCall(t){l(t)&&ge.push(t)}};Pt.extendSetup=ft(Pt);function Ee(t){return t(Pt),B}B.install=Ee;var ht=B;var It=new Map,yn=/function\s+([\p{L}\p{Nl}$_][\p{L}\p{Nl}$_\p{Mn}\p{Mc}\p{Nd}\p{Pc}]*)\s*\(/gmu,gn=async function(){}.constructor;function dt(t,e,n=!1){let i=`${t.join(",")} ${e}`;if(It.has(i))return It.get(i);let r=new(n?gn:Function)(...t,e);return It.set(i,r),r}function $e(t,e){let n=[...e.matchAll(yn)].map(i=>i[1]);try{return dt(Object.keys(t),`${e}; return {${n.map(r=>`${r}: typeof ${r} === 'function' ? ${r} : undefined`)}}; `)(...Object.values(t))}catch(i){console.warn(i.message,` `,e)}}function Ut(t){try{return new Function(`let ${t} = 0`),!0}catch{return!1}}var Ne="SVG",Ct="animate",En="none",$n="freeze",Nn="path",Se="d",Sn="transform",Te="rotate",Dt="translate",xn="offset",xe="inherit",we="finished",wn=[Te,"skewX","skewY"],An="deg",Z="px",Ae="ms",Tn=["width","height"],Ft=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");Ft=t.matches,t.addEventListener("change",()=>{Ft=t.matches})}var bn=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function On(t,e={duration:200},n=null,i=null){let r=this.gSVG,c=f=>{let h=E(f)?Object.assign({},f):{duration:f};return Ft&&(h.duration=0),h.fill=En,h},o=f=>{f=I(f)?f:[f];let h=window.getComputedStyle(this._el),y=[],$=new Set;for(let M of f){let v=Object.assign({},M);for(let A in v)!(A in h)||Tn.includes(A)?$.add(A):A===Se?v.d=`${Nn}("${v.d}")`:A===Sn&&(v.transform=p(v.transform));y.push(v)}return u($,y),y},s=[],u=(f,h)=>{if(f.size){let y=new KeyframeEffect(null,h).getKeyframes(),$=this.closest(Ne)?this.closest(Ne).getCurrentTime()*1e3:0;for(let M of f){let v=r(Ct).attributeName(M).dur(P.duration+Ae).begin((0|$+(e.delay||0))+Ae).fill($n);if(h.length===1)v.to(h[0][M]);else{let A=[],Q=[];for(let gt in y){let Ue=y[gt];M in h[gt]&&(A.push(Ue.computedOffset),Q.push(h[gt][M]))}A[0]!==0&&(A.unshift(0),Q.unshift(this[M]()||xe)),A[A.length-1]!==1&&(A.push(1),Q.push(this[M]()||xe)),v.keyTimes(A.join(";")).values(Q.join(";"))}s.push(v),v.attachTo(this)}}},p=f=>{S(f)&&(f=JSON.parse("{"+f.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let h="";for(let y in f)if(y===Te){let $=d(f[y]);$.length>1&&(h+=`${Dt}(${$[1]}${Z},${$[2]}${Z}) `),h+=`${y}(${$[0]}${a(y)}) `,$.length>1&&(h+=`${Dt}(-${$[1]}${Z},-${$[2]}${Z}) `)}else h+=`${y}(${d(f[y]).map($=>$+a(y)).join(",")}) `;return h},d=f=>I(f)?f:String(f).split(/\s+|,/),a=f=>wn.includes(f)?An:f===Dt?Z:"",N=f=>S(f)?f.replace(/(deg)|(px)/g,"").trim():f,D=f=>f.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),P=c(e),b=o(t),O=this._el.animate(b,P);return O.ready.then(()=>l(n)&&n.call(this,O)),O.finished.then(()=>{let f=b[b.length-1];for(let h in f){let y=bn(h);/^text-/.test(y)?this._el.style[h]=f[h]:h!==xn&&h in f&&this._el.setAttribute(y,y===Se?D(f[h]):N(f[h]))}s.forEach(h=>{h[we](!0);let y=this._el.querySelectorAll(Ct),$=this._el.querySelectorAll(`${Ct}[${we}]`);y.length===$.length&&y.forEach(M=>M.remove())}),l(i)&&i.call(this,O)}),this}function be(t){t.extendInstance({animateTo:On})}var Oe=Symbol(),ve=Symbol(),H=Symbol(),pt=Symbol(),mt=Symbol(),vn="unknown",Re="Graphane SVG Template Engine:",Vt=[];J({name:"g-content",execute(t,{expression:e,data:n,evalExpression:i}){t.content(i(e,n))}});J({name:"g-if",execute(t,{expression:e,data:n,evalExpression:i}){t.style.visibility(i(e,n)?"inherit":"hidden")}});J({name:"g-bind",alias:":",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:r}){let c={...i,$$:n==="d"?t.$d:n==="transform"?t.$transform:{}};c.$$.dynamic=(s,u=200,p=0)=>{t.animateTo((I(s)?s:[s]).map(d=>E(d)&&"offset"in d?{[n]:d.value,offset:d.offset}:{[n]:d}),{duration:u,delay:p})};let o=r(e,c);if(n==="class"){if(I(o)){t.classList.add(...o.filter(s=>!!s));return}if(E(o)){Object.entries(o).forEach(([s,u])=>{u?t.classList.add(s):t.classList.remove(s)});return}o&&t.classList.add(o);return}if(n==="style"){Object.entries(o).forEach(([s,u])=>t.style[s](u));return}g(o)||t[n](o)}});J({name:"g-on",alias:"@",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:r}){t[mt]=t[mt]||{};let c=t[mt][n]=t[mt][n]||new Map;c.has(e)&&t.removeEventListener(n,c.get(e));let o=function(s){let u=r(e,i,t);l(u)&&u.call(t,s)};t.addEventListener(n,o),c.set(e,o),n==="init"&&!t[Oe]&&(t[Oe]=!0,t.dispatchEvent(new Event("init")))}});J({name:"g-for",template:!0,execute(t,{expression:e,data:n}){t[H]=t[H]||[];let i=0;Mn(e,n,r=>{if(t[H][i])yt(t[H][i],r,!1);else{let c=t.gSVG("g");t.children().forEach(o=>{c.add(o.cloneNode(!0))}),yt(c,r),t.before(c.el),c[ve]=!0,t[H].push(c)}i++},r=>{for(;t[H].length>r.length;)t[H].pop().remove()})}});function J({name:t,alias:e,argument:n,template:i,execute:r}){let c=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,o=new RegExp(c,"i");Vt.push({name:t,alias:e,argument:n,template:i,execute:r,check:o})}function Rn(t){for(let e of Vt){let n=e.check.exec(t);if(n){let i=n[2];return{...e,argument:i}}}}function _n(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>e.includes(":")?e.split(":")[1]:e).map(e=>e.trim())}function Pn(t){return t[Symbol.iterator]?{iterator:[...t],type:z}:zt(t)?{iterator:Array(t<0?0:0|t).fill(0).map((e,n)=>n),type:R}:E(t)?{iterator:Object.entries(t).map(e=>e.reverse()),type:x}:{iterator:t,type:vn}}function _e(t,e,n=null){try{let i=Object.keys(e).filter(Ut);return dt(i,`return ( ${t} ); `).apply(n,i.map(c=>e[c]))}catch(i){console.warn(Re,i.message,` `,t)}}function Mn(t,e,n,i){let r="__$$iterator",c="__$$callback",o="__$$final";try{let[s,u]=t.split(" of ");s=s.trim(),u=u.trim();let p=_e(u,e)||[],{iterator:d,type:a}=Pn(p);a===x&&!s.startsWith("[")&&(s=`[${s.replace(/(^\()|(\)$)/g,"")}]`);let N=_n(s),D=s.startsWith("(")?s:`(${s})`,P=Object.keys(e).filter(Ut),b=` ${r}.forEach(${D} => { ${c}({${P}${P.length?",":""}${N.join(",")}}); }); ${o}(${r}); `;return dt([...P,r,c,o],b)(...P.map(f=>e[f]),d,n,i)}catch(s){console.warn(Re,s)}}function yt(t,e,n=!0){if(n&&t[ve])return;t[pt]=t[pt]||[];let i=t.attributes();for(let c of[...i]){let o=c.name,s=Rn(o);s&&(t[pt].push({...s,expression:c.value}),t.removeAttribute(o))}let r=!1;for(let c of t[pt])c.execute(t,{...c,data:e,evalExpression:_e}),r=c.template||r;if(!r)for(let c of t.children())yt(c,e)}function Ln(t={}){yt(this,t),this.dispatchEvent(new Event("render"))}function Pe(t){t.install(be),t.extendInstance({render:Ln}),t.extendSetup({extendTemplate:{defineDirective:J,obtainDirective(e){return Vt.find(n=>n.name===e)}}})}var Gt=Symbol(),kt=Symbol();function In(t,e){return e===Gt?t:te(t,e)}function Me(t={}){let e={};function n(a,N,D,P){return e[a]||(e[a]={}),(b=void 0,O=Gt)=>{if(S(b)||g(b)){if(O=b||Gt,O in e[a])return e[a][O]}else t=b;let f=t.reduce((h,y)=>{let $=In(y,O);return typeof $>"u"?h:h===kt?$:D(h,$)},N);return f=typeof P=="function"?P(f):f,t!==b&&(e[a][O]=f),f}}let i=n("min",kt,(a,N)=>N>a?a:N),r=n("max",kt,(a,N)=>N<a?a:N),c=n("count",0,a=>a+1),o=n("sum",0,(a,N)=>N+a),s=n("avg",{n:0,i:0},(a,N)=>(a.n++,a.i+=Number(N),a),a=>a.i/a.n),u=n("distinct",new Set,(a,N)=>(a.add(N),a),a=>[...a]),p={},d={enumerable:!1,configurable:!0,writable:!0};return"$min"in t||(p.$min={value:i,...d}),"$max"in t||(p.$max={value:r,...d}),"$sum"in t||(p.$sum={value:o,...d}),"$count"in t||(p.$count={value:c,...d}),"$avg"in t||(p.$avg={value:s,...d}),"$distinct"in t||(p.$distinct={value:u,...d}),Object.defineProperties(t,p)}var Un=t=>{t.extendSetup({extendComposer(e){l(e)?e(C.prototype):Object.assign(C.prototype,e)}})};ht.install(Pe).install(Un);var Cn="composer",Le="svg",Dn="--internal-width",Bt="update",Ie=t=>`script[type=${t}],g-script[type=${t}]`,C=class extends G{#t=null;#e=!1;isRendering=!1;async#i(e){let n=await fetch(e);if(n.status!==200)throw new Error(`${n.statusText} (${n.status}): ${n.url}`);return n.text()}async#r(){let e=[...this.querySelectorAll(Ie("plugin"))];for(let n of e){let i=n.getAttribute("src");i&&ht.install((await import(i))?.svgPlugin)}}async#s(){let e=this[m];if(this.#t=null,e.content.innerHTML="",e.svgSrc)e.content.innerHTML=await this.#i(e.svgSrc);else{let i=this.querySelector("template")?.content||this.querySelector(Le);i&&e.content.append(i.cloneNode(!0))}let n=e.content.querySelector(Le);if(n){this.#t=ht(n);let i=this.#t.viewBox(),r=S(i)?i.split(/\s|;/)[3]:0;this.shadowRoot.host.style.setProperty(Dn,`${r||250}px`)}return!0}async#n(e){let n=this[m],i=e+"Src",r=this.querySelector(Ie(e));return r&&(n[i]=r.getAttribute("src")),n[i]?this.#i(n[i]):r?.textContent}async#o(){let e=await this.#n("methods");e&&(this[m].methods=$e({$:this},e))}async#c(){let e=await this.#n("config");e&&(this[m].config=$t(e))}async#u(){let e=await this.#n("data");e&&(this[m].data=Wt(e)||Kt(e)?$t(e):Zt(e))}constructor(){super();let e=this[m];this.shadowRoot.innerHTML=` <style> :host { display : inline-block; width : var(--internal-width, 250px); height : auto; } :host([hidden]) { display : none; } </style><span id="content"></span> `,e.content=this.shadowRoot.querySelector("#content")}async[T](){await this.load()}async load(){try{this.#e=!1,await this.#r(),await Promise.all([this.#s(),this.#c(),this.#o(),this.#u()]),this.#e=!0}catch(e){return console.error(e.message),this[w]("error",e.message),!1}return this.update(!0)}async update(e=!1){if(!(this.isRendering&&!e)&&this.#t){this.isRendering=!0;let n=this[m],i=Me(n.methods.data?n.methods.data(k(n.data)):k(n.data)),r={...n.methods,...I(i)?{}:i,data:i,$:this};await this.#t.render(r),this.isRendering=!1}}get svg(){return this.#t}get loaded(){return this.#e}};C.prototype.update=re(C.prototype.update,1);ce(C).extension(fe).attribute({name:"svg-src",type:L,value:"",posUpdate:T}).attribute({name:"data",type:x,value:[],posUpdate:Bt}).attribute({name:"data-src",type:L,posUpdate:T}).property({name:"methods",type:x,value:{},posUpdate:Bt}).attribute({name:"methods-src",type:L,posUpdate:T}).attribute({name:"config",type:x,value:{},posUpdate:Bt}).attribute({name:"config-src",type:L,posUpdate:T}).tag(Cn);})(); //# sourceMappingURL=composer.js.map