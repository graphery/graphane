/* graphane - 0.1.0-alpha.3 */ (()=>{var c=new WeakMap;function m(s=()=>{}){let e=this,l=this.el.tagName.toLowerCase()==="svg"?this.el:this.closest("svg").el;if(c.has(l))return c.get(l).push(s);c.set(l,[s]);let t={},r=()=>{let a=l.getScreenCTM();if(a!==null&&(a.a!==t.a||a.b!==t.b||a.c!==t.c||a.d!==t.d||a.e!==t.e||a.f!==t.f)){let o=c.get(l);for(let b of o)b.call(e,a,t);let n=new CustomEvent("resize",{detail:{currentMatrix:a,prevMatrix:t}});e.el.dispatchEvent(n),t=a}window.requestAnimationFrame(r)};return r(),e}function f(s){s.extendInstance({resizeObserver:m})}var k=0,y=0,i=new Map,h=!1;function g(s,e=()=>{}){let l=this.el;typeof s=="string"&&(s=[s]);let t;i.has(l)?t=i.get(l):(t={computedStyles:getComputedStyle(l),styles:{},keys:[]},i.set(l,t));for(let r of s)t.styles[r]||(t.styles[r]={lastValue:t.computedStyles[r],callbacks:new Set},t.keys.push(r)),t.styles[r].callbacks.add(e);return d(),this}function d(s){if(!h||s-y<100){h=!0,k=window.requestAnimationFrame(d);return}if(!s)return;y=s;let e=null;for(let[l,t]of i.entries()){for(let r of t.keys){let a=t.computedStyles.getPropertyValue(r),o=t.styles[r].lastValue;if(a!==o){e||(e=new Map);for(let n of t.styles[r].callbacks)e.has(n)?e.get(n)[r]={current:a,last:o}:e.set(n,{[r]:{current:a,last:o}});t.styles[r].lastValue=a}}if(e){for(let[r,a]of e.entries())r.call(l,a);e=null}}k=window.requestAnimationFrame(d)}function u(s){s.extendInstance({styleObserver:g})}function v(){let s=this.closest("svg");switch(this.el.tagName.toLowerCase()){case"text":S(s,this);break;case"line":_(s,this);break;default:w(s,this)}return this}function w(s,e){let l=s.getScreenCTM()||{a:1,d:1},t=0;s.resizeObserver(r=>{let a=Math.max(r.a/l.a,r.d/l.d);e.stroke_width(t/a)}),s.styleObserver("stroke-width",r=>{let a=s.getScreenCTM();t=Number.parseFloat(r["stroke-width"].current);let o=Math.max(a.a/l.a,a.d/l.d);e.stroke_width(t/o)})}function S(s,e){let l=s.getScreenCTM()||{a:1,d:1};e.el._keepX=e.x(),e.el._keepY=e.y(),s.resizeObserver(t=>{e.transform(`scale( ${l.a/t.a}, ${l.d/t.d})`),e.x(e.el._keepX/(l.a/t.a)),e.y(e.el._keepY/(l.d/t.d))})}function _(s,e){let l=s.getScreenCTM()||{a:1,d:1};e.el._keepX1=e.x1(),e.el._keepX2=e.x2(),e.el._keepY1=e.y1(),e.el._keepY2=e.y2(),s.resizeObserver(t=>{e.transform(`scale( ${l.a/t.a}, ${l.d/t.d})`),e.x1(e.el._keepX1/(l.a/t.a)),e.x2(e.el._keepX2/(l.a/t.a)),e.y1(e.el._keepY1/(l.d/t.d)),e.y2(e.el._keepY2/(l.d/t.d))})}function p(s){s.install(f),s.install(u),s.extendInstance({keepAspect:v})}gSVG&&gSVG.install(p);})(); //# sourceMappingURL=gsvg.keep.aspect.js.map