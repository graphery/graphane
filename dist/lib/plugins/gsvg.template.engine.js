/* graphane - 0.1.0-alpha.3 */ (()=>{var pt="function",q="undefined",F="object",mt="string",W="array",D="number";var E=t=>typeof t===F,T=t=>typeof t===mt,_=t=>typeof t===pt,B=t=>typeof t===D&&!isNaN(t),L=t=>typeof t===q;var k=t=>Array.isArray(t);var z=new Map;function P(t,e){let n=`${t.join(",")} ${e}`;if(z.has(n))return z.get(n);let i=new Function(...t,e);return z.set(n,i),i}function dt(t){return t===null?null:t.constructor?new t.constructor:{}}function Y(t){if(!E(t))return t;let e=t===null?null:Object.assign(dt(t),t);for(let n in e)E(e[n])&&(e[n]=Y(e[n]));return e}function j(t,e){let n=t,i=T(e)?e.split("."):e;for(let u=0;u<i.length;u++){if(L(n[i[u]]))return;n=n[i[u]]}return n}var J=Symbol(),v=Symbol();function ht(t,e){return e===J?t:j(t,e)}function tt(t){let e={};function n(o,l,O,w){return e[o]||(e[o]={}),(x=void 0,$=J)=>{if(T(x)||L(x)){if($=x||J,$ in e[o])return e[o][$]}else t=x;let y=t.reduce((S,r)=>{let c=ht(r,$);return typeof c>"u"?S:S===v?c:O(S,c)},l);return y=typeof w=="function"?w(y):y,t!==x&&(e[o][$]=y),y}}let i=n("min",v,(o,l)=>l>o?o:l),u=n("max",v,(o,l)=>l<o?o:l),f=n("count",0,o=>o+1),a=n("sum",0,(o,l)=>l+o),s=n("avg",{n:0,i:0},(o,l)=>(o.n++,o.i+=Number(l),o),o=>o.i/o.n),m=n("distinct",new Set,(o,l)=>(o.add(l),o),o=>[...o]);return{min:i,max:u,sum:a,count:f,avg:s,distinct:m}}var et="SVG",Z="animate",$t="none",yt="freeze",Nt="path",nt="d",gt="transform",st="rotate",X="translate",xt="offset",rt="inherit",it="finished",St=[st,"skewX","skewY"],Et="deg",I="px",ot="ms",Tt=["width","height"],b=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");b=t.matches,t.addEventListener("change",()=>{b=t.matches})}var At=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function Ot(t,e={duration:200},n=null,i=null){let u=this.gSVG,f=r=>{let c=E(r)?Object.assign({},r):{duration:r};return b&&(c.duration=0),c.fill=$t,c},a=r=>{r=k(r)?r:[r];let c=window.getComputedStyle(this._el),p=[],d=new Set;for(let g of r){let N=Object.assign({},g);for(let h in N)!(h in c)||Tt.includes(h)?d.add(h):h===nt?N.d=`${Nt}("${N.d}")`:h===gt&&(N.transform=o(N.transform));p.push(N)}return m(d,p),p},s=[],m=(r,c)=>{if(r.size){let p=new KeyframeEffect(null,c).getKeyframes(),d=this.closest(et)?this.closest(et).getCurrentTime()*1e3:0;for(let g of r){let N=u(Z).attributeName(g).dur($.duration+ot).begin((0|d+(e.delay||0))+ot).fill(yt);if(c.length===1)N.to(c[0][g]);else{let h=[],M=[];for(let V in p){let lt=p[V];g in c[V]&&(h.push(lt.computedOffset),M.push(c[V][g]))}h[0]!==0&&(h.unshift(0),M.unshift(this[g]()||rt)),h[h.length-1]!==1&&(h.push(1),M.push(this[g]()||rt)),N.keyTimes(h.join(";")).values(M.join(";"))}s.push(N),N.attachTo(this)}}},o=r=>{T(r)&&(r=JSON.parse("{"+r.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let c="";for(let p in r)if(p===st){let d=l(r[p]);d.length>1&&(c+=`${X}(${d[1]}${I},${d[2]}${I}) `),c+=`${p}(${d[0]}${O(p)}) `,d.length>1&&(c+=`${X}(-${d[1]}${I},-${d[2]}${I}) `)}else c+=`${p}(${l(r[p]).map(d=>d+O(p)).join(",")}) `;return c},l=r=>k(r)?r:String(r).split(/\s+|,/),O=r=>St.includes(r)?Et:r===X?I:"",w=r=>T(r)?r.replace(/(deg)|(px)/g,"").trim():r,x=r=>r.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),$=f(e),y=a(t),S=this._el.animate(y,$);return S.ready.then(()=>_(n)&&n.call(this,S)),S.finished.then(()=>{let r=y[y.length-1];for(let c in r){let p=At(c);/^text-/.test(p)?this._el.style[c]=r[c]:c!==xt&&c in r&&this._el.setAttribute(p,p===nt?x(r[c]):w(r[c]))}s.forEach(c=>{c[it](!0);let p=this._el.querySelectorAll(Z),d=this._el.querySelectorAll(`${Z}[${it}]`);p.length===d.length&&p.forEach(g=>g.remove())}),_(i)&&i.call(this,S)}),this}function H(t){t.extendInstance({animateTo:Ot})}var ct=Symbol(),ft=Symbol(),A=Symbol(),C=Symbol(),U=Symbol(),wt="unknown",ut="Graphane SVG Template Engine:",K=[],_t=t=>t.reduce((e,n)=>(e[n]=(...i)=>`${n}(${i.join(",")}) `,e),{}),Lt=["transform","gradientTransform","patternTransform"],kt=_t(["matrix","matrix3d","perspective","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"]);R({name:"g-content",execute(t,{expression:e,data:n,evalExpression:i}){t.content(i(e,n))}});R({name:"g-if",execute(t,{expression:e,data:n,evalExpression:i}){t.style.visibility(i(e,n)?"inherit":"hidden")}});R({name:"g-bind",alias:":",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:u}){let f={...i,...Lt.includes(n)?kt:{},$:{...i.$,d:n==="d"?t.$d:void 0,dynamic(s,m=200,o=0){t.animateTo((k(s)?s:[s]).map(l=>E(l)?{[n]:l.value,offset:l.offset}:{[n]:l}),{duration:m,delay:o})}}},a=u(e,f);if(n==="class"){if(k(a)){t.classList.add(...a.filter(s=>!!s));return}if(E(a)){Object.entries(a).forEach(([s,m])=>{m?t.classList.add(s):t.classList.remove(s)});return}a&&t.classList.add(a);return}if(n==="style"){Object.entries(a).forEach(([s,m])=>t.style[s](m));return}L(a)||t[n](n==="d"?""+a:a)}});R({name:"g-on",alias:"@",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:u}){t[U]=t[U]||{};let f=t[U][n]=t[U][n]||new Map;f.has(e)&&t.removeEventListener(n,f.get(e));let a=function(s){let m=u(e,i);_(m)&&m.call(t,s)};t.addEventListener(n,a),f.set(e,a),n==="init"&&!t[ct]&&(t[ct]=!0,t.dispatchEvent(new Event("init")))}});R({name:"g-for",template:!0,execute(t,{expression:e,data:n}){t[A]=t[A]||[];let i=0;Mt(e,n,u=>{if(t[A][i])G(t[A][i],u,!1);else{let f=t.gSVG("g");t.children().forEach(a=>{f.add(a.cloneNode(!0))}),G(f,u),t.before(f.el),f[ft]=!0,t[A].push(f)}i++},u=>{for(;t[A].length>u.length;)t[A].pop().remove()})}});function R({name:t,alias:e,argument:n,template:i,execute:u}){let f=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,a=new RegExp(f,"i");K.push({name:t,alias:e,argument:n,template:i,execute:u,check:a})}function Rt(t){for(let e of K){let n=e.check.exec(t);if(n){let i=n[2];return{...e,argument:i}}}}function Ft(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>e.includes(":")?e.split(":")[1]:e).map(e=>e.trim())}function It(t){return t[Symbol.iterator]?{iterator:[...t],type:W}:B(t)?{iterator:Array(t<0?0:t).fill(0).map((e,n)=>n),type:D}:E(t)?{iterator:Object.entries(t).map(e=>e.reverse()),type:F}:{iterator:t,type:wt}}function at(t,e){try{return P(Object.keys(e).filter(i=>!B(i)),`return ( ${t} ); `)(...Object.values(e))}catch(n){console.warn(ut,n.message)}}function Mt(t,e,n,i){let u="__$$iterator",f="__$$callback",a="__$$final";try{let[s,m]=t.split(" of ");s=s.trim(),m=m.trim();let o=at(m,e)||[],{iterator:l,type:O}=It(o);O===F&&s[0]!=="["&&(s=`[${s.replace(/(^\()|(\)$)/g,"")}]`);let w=Ft(s),x=s[0]!=="("?`(${s})`:s,$=Object.keys(e),y=` ${u}.forEach(${x} => { ${f}({${$}${$.length?",":""}${w.join(",")}}); }); ${a}(${u}); `;return P([...$,u,f,a],y)(...Object.values(e),l,n,i)}catch(s){console.warn(ut,s)}}function G(t,e,n=!0){if(n&&t[ft])return;t[C]=t[C]||[];let i=t.attributes();for(let f of[...i]){let a=f.name,s=Rt(a);s&&(t[C].push({...s,expression:f.value}),t.removeAttribute(a))}let u=!1;for(let f of t[C])f.execute(t,{...f,data:e,evalExpression:at}),u=f.template||u;if(!u)for(let f of t.children())G(f,e)}function Dt(t={}){G(this,{...t,...Array.isArray(t.data)?{}:t.data,$:t.data?{...t.$,...tt(t.data),data:t.data,rawData:Y(t.data)}:{}})}function Q(t){H(t),t.extendInstance({render:Dt}),t.extendSetup({extendTemplate:{defineDirective:R,obtainDirective(e){return K.find(n=>n.name===e)}}})}gSVG&&gSVG.install(Q);})(); //# sourceMappingURL=gsvg.template.engine.js.map