/* graphane - 0.1.0-alpha.1 */ (()=>{var lt="function",q="undefined",R="object",pt="string",W="array",C="number";var S=t=>typeof t===R,O=t=>typeof t===pt,_=t=>typeof t===lt,V=t=>typeof t===C&&!isNaN(t),k=t=>typeof t===q;var F=t=>Array.isArray(t);var B=new Map;function z(t,e){let n=`${t.join(",")} ${e}`;if(B.has(n))return B.get(n);let i=new Function(...t,e);return B.set(n,i),i}function mt(t){return t===null?null:t.constructor?new t.constructor:{}}function Y(t){if(!S(t))return t;let e=t===null?null:Object.assign(mt(t),t);for(let n in e)S(e[n])&&(e[n]=Y(e[n]));return e}function j(t,e){let n=t,i=O(e)?e.split("."):e;for(let a=0;a<i.length;a++){if(k(n[i[a]]))return;n=n[i[a]]}return n}var J=Symbol(),P=Symbol();function dt(t,e){return e===J?t:j(t,e)}function tt(t){let e={};function n(o,p,A,w){return e[o]||(e[o]={}),(x=void 0,h=J)=>{if(O(x)||k(x)){if(h=x||J,h in e[o])return e[o][h]}else t=x;let y=t.reduce((E,r)=>{let c=dt(r,h);return typeof c>"u"?E:E===P?c:A(E,c)},p);return y=typeof w=="function"?w(y):y,t!==x&&(e[o][h]=y),y}}let i=n("min",P,(o,p)=>p>o?o:p),a=n("max",P,(o,p)=>p<o?o:p),f=n("count",0,o=>o+1),u=n("sum",0,(o,p)=>p+o),s=n("avg",{n:0,i:0},(o,p)=>(o.n++,o.i+=Number(p),o),o=>o.i/o.n),d=n("distinct",new Set,(o,p)=>(o.add(p),o),o=>[...o]);return{min:i,max:a,sum:u,count:f,avg:s,distinct:d}}var et="SVG",Z="animate",ht="none",$t="freeze",yt="path",nt="d",gt="transform",st="rotate",X="translate",Nt="offset",rt="inherit",it="finished",xt=[st,"skewX","skewY"],Et="deg",I="px",ot="ms",b=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");b=t.matches,t.addEventListener("change",()=>{b=t.matches})}var St=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function Ot(t,e={duration:200},n=null,i=null){let a=this.gSVG,f=r=>{let c=S(r)?Object.assign({},r):{duration:r};return b&&(c.duration=0),c.fill=ht,c},u=r=>{r=F(r)?r:[r];let c=window.getComputedStyle(this._el),l=[],m=new Set;for(let N of r){let g=Object.assign({},N);for(let $ in g)$ in c?$===nt?g.d=`${yt}("${g.d}")`:$===gt&&(g.transform=o(g.transform)):m.add($);l.push(g)}return d(m,l),l},s=[],d=(r,c)=>{if(r.size){let l=new KeyframeEffect(null,c).getKeyframes(),m=this.closest(et)?this.closest(et).getCurrentTime()*1e3:0;for(let N of r){let g=a(Z).attributeName(N).dur(h.duration+ot).begin((0|m+(e.delay||0))+ot).fill($t);if(c.length===1)g.to(c[0][N]);else{let $=[],D=[];for(let G in l){let at=l[G];N in c[G]&&($.push(at.computedOffset),D.push(c[G][N]))}$[0]!==0&&($.unshift(0),D.unshift(this[N]()||rt)),$[$.length-1]!==1&&($.push(1),D.push(this[N]()||rt)),g.keyTimes($.join(";")).values(D.join(";"))}s.push(g),g.attachTo(this)}}},o=r=>{O(r)&&(r=JSON.parse("{"+r.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let c="";for(let l in r)if(l===st){let m=p(r[l]);m.length>1&&(c+=`${X}(${m[1]}${I},${m[2]}${I}) `),c+=`${l}(${m[0]}${A(l)}) `,m.length>1&&(c+=`${X}(-${m[1]}${I},-${m[2]}${I}) `)}else c+=`${l}(${p(r[l]).map(m=>m+A(l)).join(",")}) `;return c},p=r=>F(r)?r:String(r).split(/\s+|,/),A=r=>xt.includes(r)?Et:r===X?I:"",w=r=>O(r)?r.replace(/(deg)|(px)/g,"").trim():r,x=r=>r.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),h=f(e),y=u(t),E=this._el.animate(y,h);return E.ready.then(()=>_(n)&&n.call(this,E)),E.finished.then(()=>{let r=y[y.length-1];for(let c in r){let l=St(c);/^text-/.test(l)?this._el.style[c]=r[c]:c!==Nt&&c in r&&this._el.setAttribute(l,l===nt?x(r[c]):w(r[c]))}s.forEach(c=>{c[it](!0);let l=this._el.querySelectorAll(Z),m=this._el.querySelectorAll(`${Z}[${it}]`);l.length===m.length&&l.forEach(N=>N.remove())}),_(i)&&i.call(this,E)}),this}function H(t){t.extendInstance({animateTo:Ot})}var ct=Symbol(),T=Symbol(),U=Symbol(),M=Symbol(),Tt="unknown",ft="Graphane SVG Template Engine:",K=[],At=t=>t.reduce((e,n)=>(e[n]=(...i)=>`${n}(${i.join(",")}) `,e),{}),wt=["transform","gradientTransform","patternTransform"],_t=At(["matrix","matrix3d","perspective","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"]);L({name:"g-content",execute(t,{expression:e,data:n,evalExpression:i}){t.content(i(e,n))}});L({name:"g-if",execute(t,{expression:e,data:n,evalExpression:i}){t.style.visibility(i(e,n)?"inherit":"hidden")}});L({name:"g-bind",alias:":",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:a}){let f={...i,...wt.includes(n)?_t:{},$:{...i.$,d:n==="d"?t.$d:void 0,animate(s,d=200,o=0){t.animateTo({[n]:s},{duration:d,delay:o})}}},u=a(e,f);if(n==="class"){if(F(u)){t.classList.add(...u.filter(s=>!!s));return}if(S(u)){Object.entries(u).forEach(([s,d])=>{d?t.classList.add(s):t.classList.remove(s)});return}u&&t.classList.add(u);return}if(n==="style"){Object.entries(u).forEach(([s,d])=>t.style[s](d));return}k(u)||t[n](n==="d"?""+u:u)}});L({name:"g-on",alias:"@",argument:!0,execute(t,{expression:e,argument:n,data:i,evalExpression:a}){let f=a(e,i);t[M]=t[M]||{};let u=t[M][n];if(_(f)){u&&!u.has(f)&&t.removeEventListener(n,[...u.values()][0]);let s=d=>f.call(t,d);t.addEventListener(n,s),t[M][n]=new Map,t[M][n].set(f,s),n==="load"&&t.dispatchEvent(new Event("load"))}}});L({name:"g-for",template:!0,execute(t,{expression:e,data:n}){t[T]=t[T]||[];let i=0;Ft(e,n,a=>{if(t[T][i])v(t[T][i],a,!1);else{let f=t.gSVG("g");t.children().forEach(u=>{f.add(u.cloneNode(!0))}),v(f,a),t.before(f.el),f[ct]=!0,t[T].push(f)}i++},a=>{for(;t[T].length>a.length;)t[T].pop().remove()})}});function L({name:t,alias:e,argument:n,template:i,execute:a}){let f=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,u=new RegExp(f,"i");K.push({name:t,alias:e,argument:n,template:i,execute:a,check:u})}function kt(t){for(let e of K){let n=e.check.exec(t);if(n){let i=n[2];return{...e,argument:i}}}}function Lt(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>e.includes(":")?e.split(":")[1]:e).map(e=>e.trim())}function Rt(t){return t[Symbol.iterator]?{iterator:[...t],type:W}:V(t)?{iterator:Array(t<0?0:t).fill(0).map((e,n)=>n),type:C}:S(t)?{iterator:Object.entries(t).map(e=>e.reverse()),type:R}:{iterator:t,type:Tt}}function ut(t,e){try{return z(Object.keys(e).filter(i=>!V(i)),`return ( ${t} ); `)(...Object.values(e))}catch(n){console.warn(ft,n.message)}}function Ft(t,e,n,i){let a="__$$iterator",f="__$$callback",u="__$$final";try{let[s,d]=t.split(" of ");s=s.trim(),d=d.trim();let o=ut(d,e)||[],{iterator:p,type:A}=Rt(o);A===R&&s[0]!=="["&&(s=`[${s.replace(/(^\()|(\)$)/g,"")}]`);let w=Lt(s),x=s[0]!=="("?`(${s})`:s,h=Object.keys(e),y=` ${a}.forEach(${x} => { ${f}({${h}${h.length?",":""}${w.join(",")}}); }); ${u}(${a}); `;return z([...h,a,f,u],y)(...Object.values(e),p,n,i)}catch(s){console.warn(ft,s)}}function v(t,e,n=!0){if(n&&t[ct])return;t[U]=t[U]||[];let i=t.attributes();for(let f of[...i]){let u=f.name,s=kt(u);s&&(t[U].push({...s,expression:f.value}),t.removeAttribute(u))}let a=!1;for(let f of t[U])f.execute(t,{...f,data:e,evalExpression:ut}),a=f.template||a;if(!a)for(let f of t.children())v(f,e)}function It(t={}){v(this,{...t,...Array.isArray(t.data)?{}:t.data,$:t.data?{...t.$,...tt(t.data),data:t.data,rawData:Y(t.data)}:{}})}function Q(t){H(t),t.extendInstance({render:It}),t.extendSetup({extendTemplate:{defineDirective:L,obtainDirective(e){return K.find(n=>n.name===e)}}})}gSVG&&gSVG.install(Q);})(); //# sourceMappingURL=gsvg.template.engine.js.map