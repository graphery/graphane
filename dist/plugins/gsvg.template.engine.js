/* graphane - 0.1.0-alpha.6 */ (()=>{var st="function",ct="undefined",I="object",at="string",H="array",C="number";var A=t=>typeof t===I,j=t=>typeof t===at,L=t=>typeof t===st,J=t=>typeof t===C&&!isNaN(t),Y=t=>typeof t===ct;var S=t=>Array.isArray(t);var K=t=>t.replace(/-([a-z0-9])/g,(e,r)=>r.toUpperCase());var V=new Map;var ft=async function(){}.constructor;function G(t,e,r=!1){let o=`${t.join(",")} ${e}`;if(V.has(o))return V.get(o);let f=new(r?ft:Function)(...t,e);return V.set(o,f),f}function U(t){try{return new Function(`let ${t} = 0`),!0}catch{return!1}}var B="animate",ut="path",Z="d",q="transform",v="rotate",g="translate",Q="inherit",X="finished",lt=[v,"skewX","skewY"],pt=[g,"width","height","x","y","cx","cy","r","rx","ry","dx","dy"],mt=(t,e)=>["text","tspan"].includes(t)&&["x","y"].includes(e),P=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");P=t.matches,t.addEventListener("change",()=>{P=t.matches})}var dt=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function ht(t,e={duration:200},r=null,o=null){let f=this.gSVG,c=n=>{let i=A(n)?{...n}:{duration:n};return P&&(i.duration=0),i.fill="none",i},u=n=>{n=S(n)?n:[n];let i=window.getComputedStyle(this._el),s=[],l=new Set;for(let $ of n){let m={};for(let y in $){let d=K(y);m[d]=x($[y],d),!(d in i)||mt(this.tagName(),d)?l.add(d):d===Z?m.d=`${ut}("${m.d}")`:d===q&&(m.transform=T(m.transform))}s.push(m)}return p(l,s),s},a=[],p=(n,i)=>{if(n.size){let s=new KeyframeEffect(null,i).getKeyframes();for(let l of n){let $=f(B).attributeName(l).dur(_.duration+"ms").fill("freeze");if(i.length===1)$.to(i[0][l]);else{let m=[],y=[];for(let d in s){let ot=s[d];l in i[d]&&(m.push(ot.computedOffset),y.push(i[d][l]))}m[0]!==0&&(m.unshift(0),y.unshift(this[l]()||Q)),m[m.length-1]!==1&&(m.push(1),y.push(this[l]()||Q)),$.keyTimes(m.join(";")).values(y.join(";"))}a.push($),$.attachTo(this),$.beginElementAt(_.delay||0)}}},T=n=>{j(n)&&(n=JSON.parse("{"+n.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let i="";for(let s in n)if(s===v){let l=h(n[s]);l.length>1&&(i+=`${g}(${x(l[1],g)},${x(l[2],g)}) `),i+=`${s}(${x(l[0],s)}) `,l.length>1&&(i+=`${g}(-${x(l[1],g)},-${x(l[2],g)}) `)}else i+=`${s}(${h(n[s]).map(l=>x(l,s)).join(",")}) `;return i},h=n=>S(n)?n:String(n).split(/\s+|,/),x=(n,i)=>lt.includes(i)?n+"deg":pt.includes(i)?n+"px":n,O=n=>j(n)?n.replace(/(deg)|(px)/g,"").trim():n,R=n=>n.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),E=n=>{let i=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,s=i.exec(n);return s&&Number(s[1])===Number(s[4])*-1&&Number(s[2])===Number(s[5])*-1?n=n.replace(i,`rotate(${s[3]}, ${s[1]}, ${s[2]})`):n=O(n),n},_=c(e),k=u(t),b=this._el.animate(k,_);return b.ready.then(()=>L(r)&&r.call(this,b)),b.finished.then(()=>{let n=k[k.length-1];for(let i in n){let s=dt(i);s.startsWith("text-")?this._el.style[i]=n[i]:i!=="offset"&&i in n&&this._el.setAttribute(s,s===Z?R(n[i]):s===q?E(n[i]):O(n[i]))}a.forEach(i=>{i[X](!0);let s=this._el.querySelectorAll(B),l=this._el.querySelectorAll(`${B}[${X}]`);s.length===l.length&&s.forEach($=>$.remove())}),L(o)&&o.call(this,b)}),this}function $t(t){t.extendInstance({animateTo:ht})}var tt=$t;var et=Symbol(),nt=Symbol(),N=Symbol(),M=Symbol(),F=Symbol(),xt="unknown",rt="Graphane SVG Template Engine:",W=[];w({name:"g-content",execute(t,{expression:e,data:r,evalExpression:o}){t.content(o(e,r))}});w({name:"g-if",execute(t,{expression:e,data:r,evalExpression:o}){t.style.visibility(o(e,r)?"inherit":"hidden")}});w({name:"g-bind",alias:":",argument:!0,execute(t,{expression:e,argument:r,data:o,evalExpression:f}){let c={...o,$$:["d","transform"].includes(r)?t["$"+r]:()=>t[r]()};c.$$.dynamic=(a,p=200,T=0)=>{t.animateTo((S(a)?a:[a]).map(h=>A(h)&&"offset"in h?{[r]:h.value,offset:h.offset}:{[r]:h}),{duration:p,delay:T})};let u=f(e,c);if(r==="class"){if(S(u)){t.classList.add(...u.filter(a=>!!a));return}if(A(u)){Object.entries(u).forEach(([a,p])=>{p?t.classList.add(a):t.classList.remove(a)});return}u&&t.classList.add(u);return}if(r==="style"){Object.entries(u).forEach(([a,p])=>t.style[a](p));return}Y(u)||t[r](u)}});w({name:"g-on",alias:"@",argument:!0,execute(t,{expression:e,argument:r,data:o,evalExpression:f}){t[F]=t[F]||{};let c=t[F][r]=t[F][r]||new Map;c.has(e)&&t.removeEventListener(r,c.get(e));let u=function(a){let p=f(e,o,t);L(p)&&p.call(t,a)};t.addEventListener(r,u),c.set(e,u),r==="init"&&!t[et]&&(t[et]=!0,t.dispatchEvent(new Event("init")))}});w({name:"g-for",template:!0,execute(t,{expression:e,data:r}){t[N]=t[N]||[];let o=0;Et(e,r,f=>{if(t[N][o])D(t[N][o],f,!1);else{let c=t.gSVG("g");t.children().forEach(u=>{c.add(u.cloneNode(!0))}),D(c,f),t.before(c.el),c[nt]=!0,t[N].push(c)}o++},f=>{for(;t[N].length>f.length;)t[N].pop().remove()})}});function w({name:t,alias:e,argument:r,template:o,execute:f}){let c=`^(${t}${r?":":""}${e?`|${e})`:")"}${r?"(.*)$":"$"}`,u=new RegExp(c,"i");W.push({name:t,alias:e,argument:r,template:o,execute:f,check:u})}function yt(t){for(let e of W){let r=e.check.exec(t);if(r){let o=r[2];return{...e,argument:o}}}}function gt(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>e.includes(":")?e.split(":")[1]:e).map(e=>e.trim())}function Nt(t){return t[Symbol.iterator]?{iterator:[...t],type:H}:J(t)?{iterator:Array(t<0?0:0|t).fill(0).map((e,r)=>r),type:C}:A(t)?{iterator:Object.entries(t).map(e=>e.reverse()),type:I}:{iterator:t,type:xt}}function it(t,e,r=null){try{let o=Object.keys(e).filter(U);return G(o,`return ( ${t} ); `).apply(r,o.map(c=>e[c]))}catch(o){console.warn(rt,o.message,` `,t)}}function Et(t,e,r,o){let f="__$$iterator",c="__$$callback",u="__$$final";try{let[a,p]=t.split(" of ");a=a.trim(),p=p.trim();let T=it(p,e)||[],{iterator:h,type:x}=Nt(T);x===I&&!a.startsWith("[")&&(a=`[${a.replace(/(^\()|(\)$)/g,"")}]`);let O=gt(a),R=a.startsWith("(")?a:`(${a})`,E=Object.keys(e).filter(U),_=` ${f}.forEach(${R} => { ${c}({${E}${E.length?",":""}${O.join(",")}}); }); ${u}(${f}); `;return G([...E,f,c,u],_)(...E.map(b=>e[b]),h,r,o)}catch(a){console.warn(rt,a)}}function D(t,e,r=!0){if(r&&t[nt])return;t[M]=t[M]||[];let o=t.attributes();for(let c of[...o]){let u=c.name,a=yt(u);a&&(t[M].push({...a,expression:c.value}),t.removeAttribute(u))}let f=!1;for(let c of t[M])c.execute(t,{...c,data:e,evalExpression:it}),f=c.template||f;if(!f)for(let c of t.children())D(c,e)}function bt(t={}){D(this,t),this.dispatchEvent(new Event("render"))}function At(t){t.install(tt),t.extendInstance({render:bt}),t.extendSetup({extendTemplate:{defineDirective:w,obtainDirective(e){return W.find(r=>r.name===e)}}})}var z=At;gSVG&&gSVG.install(z);customElements.whenDefined("g-composer").then(t=>{t.install(z)});})();